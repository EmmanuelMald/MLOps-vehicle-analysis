

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../machine_learning/">
      
      
      <link rel="icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.37">
    
    
      
        <title>Data preparation - Vehicle Emmissions and Autonomy Estimator</title>
      
    
    

      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
      


    
<link rel="stylesheet" type="text/css" href="../css/fonts.css" />
<link rel="stylesheet" type="text/css" href="../css/style.css" />

    
      
    
    
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    

<script type="text/javascript">
    if ( window !== window.parent ) {
        // The page is in an iframe
        window.addEventListener("DOMContentLoaded", function externalLinks() {
            var anchors = document.getElementsByTagName("a");
            for (var i = 0; i < anchors.length; i++) {
                    if (anchors[i].hostname !== window.location.hostname) {
                        anchors[i].setAttribute("target", "_blank");
                        anchors[i].setAttribute("rel", "noopener");
                    }
                    // Handle 'Open in SWAN' badges in the parent JupyterLab window
                    if (anchors[i].hostname == 'cern.ch' && anchors[i].pathname == '/swanserver/cgi-bin/go') {
                        const projectUrl = new URLSearchParams(anchors[i].search).get('projurl');
                        if (projectUrl) {
                                anchors[i].onclick = () => {
                                window.parent.postMessage(projectUrl,'*');
                                //  Skip redirecting the iframe page to the link 
                                return false;
                            }
                        }
                    }
            }
        }); 
    }
</script>

  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#data-preparation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Vehicle Emmissions and Autonomy Estimator" class="md-header__button md-logo" aria-label="Vehicle Emmissions and Autonomy Estimator" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vehicle Emmissions and Autonomy Estimator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Data preparation
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Vehicle Emmissions and Autonomy Estimator" class="md-nav__button md-logo" aria-label="Vehicle Emmissions and Autonomy Estimator" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    Vehicle Emmissions and Autonomy Estimator
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Data preparation
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Data preparation
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-source" class="md-nav__link">
    <span class="md-ellipsis">
      Data Source
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Transformation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Transformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-data-understanding" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Data Understanding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-data-types" class="md-nav__link">
    <span class="md-ellipsis">
      Changing Data Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-imputation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Imputation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dropping-duplicates" class="md-nav__link">
    <span class="md-ellipsis">
      Dropping Duplicates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-the-unit-of-measure" class="md-nav__link">
    <span class="md-ellipsis">
      Changing the Unit of Measure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renaming-columns" class="md-nav__link">
    <span class="md-ellipsis">
      Renaming Columns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-load" class="md-nav__link">
    <span class="md-ellipsis">
      Data Load
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Machine Learning models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Machine Learning models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../machine_learning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Tools implemented
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../co2_estimator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CO2 emissions estimator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../autonomy_estimator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autonomy estimator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model deployment
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#data-source" class="md-nav__link">
    <span class="md-ellipsis">
      Data Source
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-transformation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Transformation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Data Transformation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#basic-data-understanding" class="md-nav__link">
    <span class="md-ellipsis">
      Basic Data Understanding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-data-types" class="md-nav__link">
    <span class="md-ellipsis">
      Changing Data Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-imputation" class="md-nav__link">
    <span class="md-ellipsis">
      Data Imputation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dropping-duplicates" class="md-nav__link">
    <span class="md-ellipsis">
      Dropping Duplicates
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#changing-the-unit-of-measure" class="md-nav__link">
    <span class="md-ellipsis">
      Changing the Unit of Measure
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#renaming-columns" class="md-nav__link">
    <span class="md-ellipsis">
      Renaming Columns
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-load" class="md-nav__link">
    <span class="md-ellipsis">
      Data Load
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="data-preparation"><strong><em>Data Preparation</em></strong></h1>
<p>An ETL pipeline was implemented using pandas due to the amount of information is relatively small (thousands of rows); Nevertheless, if the amount of data reach millions or billions of rows, it might be worth it to implement distributed computing with pyspark. </p>
<p>ETL stands for Extract-Transform-Load, it refers to gather information from some data source, modify this data to convert it in a more valuable asset, and then load or save this processed data in a database or file.</p>
<h2 id="data-source"><strong><em>Data Source</em></strong></h2>
<p>Both machine learning models uses information from the <a href="https://public.opendatasoft.com/explore/dataset/all-vehicles-model/table/?sort=modifiedon"><strong><em>All Vehicles Model dataset</em></strong></a> from <em>OpenDataSoft</em>. This dataset has licence of <em>public domain</em>, and is constantly being updated with the most recent vehicle models. </p>
<p>Up to the time this documentation is being written (September 2024), the most recent model year is 2024, and the last time this dataset was updated was in June 3, 2024.</p>
<p>Nevertheless, this project has been configured to retrieve the last version of this dataset each time that the notebooks are run.</p>
<p>The dataset has some column names that might not be so self-descriptive Nevertheless, this dataset has some metadata that can be used to understand the columns, in this case, a json file was created to store the metadata, which can be consulted <a href="https://public.opendatasoft.com/explore/dataset/all-vehicles-model/information/?sort=modifiedon"><strong>here</strong></a>.</p>
<h2 id="data-transformation"><strong><em>Data Transformation</em></strong></h2>
<p>Some of the processes that were implemented are:</p>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</p>
<h3 id="basic-data-understanding"><strong><em>Basic Data Understanding</em></strong></h3>
<p>=======
<strong>Basic Data Understanding</strong></p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>bd5c342f535b4d36b9a7cf75f46e949980ed4208</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>Data understanding is not a data transformation process itself, but I consider important to understand the basics of each column, some of the questions answered in this process were:</p>
<ul>
<li>Does a column has the necessary not null values to be set as a parameter for the ML model? <em>In this section, if the column has a lot of missing values - more than 80%, then I wasn't used</em> </li>
</ul>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
- Is the information in that column meaningful for the model? <em>(This is a first approach, but It will be addressed in depth during feature selection - described in the <a href="http://localhost:8000/machine_learning/"><strong>Machine learning models</strong></a> section)</em></p>
<ul>
<li>Are the column information easily retrievable/known to set it as a parameter to the models? <em>Its important to define parameters that can truly be known and set as entries of the model</em></li>
</ul>
<p>This first analysis was achievable using the metadata and some basic Exploratory Data Analysis.</p>
<h3 id="changing-data-types"><strong><em>Changing Data Types</em></strong></h3>
<p>There were some columns that should be used as numbers, or bool values, but the dataset was trating them as strings or viceversa. In that case, its important to set the right values to the columns to avoid errors. </p>
<h3 id="data-imputation"><strong><em>Data Imputation</em></strong></h3>
<p>=======
- Is the information in that column meaningful for the model? <em>(This is a first approach, but It will be addressed in depth during feature selection)</em></p>
<ul>
<li>Are the column information easily retrievable/known to set it as a parameter to the models? <em>Its important to define parameters that can truly be known</em></li>
</ul>
<p>Using the metadata and some basic Exploratory Data Analysis, some columns of the dataset were chosen to create the ML models. </p>
<p><strong>Changing the data type of some columns</strong></p>
<p>There were some columns that should be used as numbers, or bool values, but the dataset was trating them as strings or viceversa. In that case, its important to set the right values to the columns to avoid errors. </p>
<p><strong>Data imputation</strong></p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>bd5c342f535b4d36b9a7cf75f46e949980ed4208</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>Is the process in which some missing data is filled with values according to the data. Use this method carefully, as this can modify the data distribution.</p>
<p>There are different methods for data imputation based on the type of the data and its context. For this project, some of the methods implemented were:</p>
<p><em>KNNImputer:</em> </p>
<p>This imputation model takes all the other features as inputs for a KNN model, where the target is the column that is trying to be imputed. </p>
<p>For each null row, it sets the mean value of the K nearest neighbors.</p>
<p>This model, even when is used to set either categorical or numerical values, needs to work with numbers, so converting all the categorical features into numeric ones is mandatory.</p>
<p>All the features (numeric and categorical) were encoded using the OrdinalEncoder.</p>
<p><em>Setting a value that represents the missing data</em></p>
<p>In this case, 'False', '0', and 'None', are some of the values used on the different types of missing data.</p>
<p>&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD</p>
<h3 id="dropping-duplicates"><strong><em>Dropping Duplicates</em></strong></h3>
<p>Even when each row in the dataset has an unique ID, some columns that will be used by the model has the same values, so this rows were dropped. </p>
<h3 id="changing-the-unit-of-measure"><strong><em>Changing the Unit of Measure</em></strong></h3>
<p>Some columns were originally measure using the english system of units. Nevertheless, to have a more intuitive vision of the units, the International  System of Units was used. To do so, some transformations had to be done.</p>
<h3 id="renaming-columns"><strong><em>Renaming Columns</em></strong></h3>
<p>As the original dataset didn't have intuitive column names, it was decided to change those names to more intuitive ones.</p>
<p>=======
<strong>Dropping duplicates</strong></p>
<p>Even when each row in the dataset has an unique ID, some columns that will be used by the model has the same values, so this rows were dropped. </p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>bd5c342f535b4d36b9a7cf75f46e949980ed4208</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<h2 id="data-load"><strong><em>Data Load</em></strong></h2>
<p>Once the data was cleaned, the resulting dataset were saved as <em>vehicle_data_prepared.parquet</em>. </p>
<p>Some of the advantages of the <em>parquet</em> extension over the <em>csv</em> or <em>xslx</em> extension is that the parquet file uses a column storage process rather than csv and xslx, that uses row storage process. This is a more efficient way to store data as it can retrieve only some columns instead of the whole dataset if needed. Also, parquet works better for large amount of data.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class=" text">
    <p>SWAN © Copyright CERN 2016-2024. All rights reserved.</p>
    <ul>
        <li><a target="_blank" href="https://cern.ch/swan/">Home</a></li>
        <li><a target="_blank" href="https://cern.ch/swan-community/">Community</a></li>
        <li><a target="_blank" href="https://cern.service-now.com/service-portal/?id=functional_element&name=swan">Support</a></li>
        <li><a target="_blank" href="https://github.com/swan-cern">Github</a></li>
    </ul>
    <p class="poweredby">Powered by <strong><a href="https://www.mkdocs.org">MkDocs</a></strong> and <strong><a href="https://squidfunk.github.io/mkdocs-material/"> Material for MkDocs</a></strong></p>
</div>
<div class="md-layout-grid--align-right logo">
    <img src="../images/logo_cern.png" alt="CERN">
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6f25eb3.min.js"></script>
      
        <script src="../search/main.js"></script>
      
    
  </body>
</html>