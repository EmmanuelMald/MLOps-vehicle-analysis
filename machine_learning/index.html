

<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../data_preparation/">
      
      
        <link rel="next" href="../co2_estimator/">
      
      
      <link rel="icon" href="../images/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.37">
    
    
      
        <title>Tools implemented - Vehicle Emmissions and Autonomy Estimator</title>
      
    
    

      <link rel="stylesheet" href="../assets/stylesheets/main.8c3ca2c6.min.css">
      
      


    
<link rel="stylesheet" type="text/css" href="../css/fonts.css" />
<link rel="stylesheet" type="text/css" href="../css/style.css" />

    
      
    
    
      
    
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    

<script type="text/javascript">
    if ( window !== window.parent ) {
        // The page is in an iframe
        window.addEventListener("DOMContentLoaded", function externalLinks() {
            var anchors = document.getElementsByTagName("a");
            for (var i = 0; i < anchors.length; i++) {
                    if (anchors[i].hostname !== window.location.hostname) {
                        anchors[i].setAttribute("target", "_blank");
                        anchors[i].setAttribute("rel", "noopener");
                    }
                    // Handle 'Open in SWAN' badges in the parent JupyterLab window
                    if (anchors[i].hostname == 'cern.ch' && anchors[i].pathname == '/swanserver/cgi-bin/go') {
                        const projectUrl = new URLSearchParams(anchors[i].search).get('projurl');
                        if (projectUrl) {
                                anchors[i].onclick = () => {
                                window.parent.postMessage(projectUrl,'*');
                                //  Skip redirecting the iframe page to the link 
                                return false;
                            }
                        }
                    }
            }
        }); 
    }
</script>

  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#machine-learning-models" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Vehicle Emmissions and Autonomy Estimator" class="md-header__button md-logo" aria-label="Vehicle Emmissions and Autonomy Estimator" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Vehicle Emmissions and Autonomy Estimator
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Tools implemented
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Vehicle Emmissions and Autonomy Estimator" class="md-nav__button md-logo" aria-label="Vehicle Emmissions and Autonomy Estimator" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    Vehicle Emmissions and Autonomy Estimator
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Introduction
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../data_preparation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data preparation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Machine Learning models
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Machine Learning models
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Tools implemented
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Tools implemented
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#feature-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-development" class="md-nav__link">
    <span class="md-ellipsis">
      Model Development
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#feature-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feature-normalization" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Normalization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Pipeline Generation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Model Evaluation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#r2" class="md-nav__link">
    <span class="md-ellipsis">
      R2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root-mean-squared-error-rmse" class="md-nav__link">
    <span class="md-ellipsis">
      Root Mean Squared Error (RMSE)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../co2_estimator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CO2 emissions estimator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../autonomy_estimator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Autonomy estimator
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Model deployment
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#feature-selection" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Selection
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-development" class="md-nav__link">
    <span class="md-ellipsis">
      Model Development
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Development">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#feature-encoding" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Encoding
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#feature-normalization" class="md-nav__link">
    <span class="md-ellipsis">
      Feature Normalization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pipeline-generation" class="md-nav__link">
    <span class="md-ellipsis">
      Pipeline Generation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#model-evaluation" class="md-nav__link">
    <span class="md-ellipsis">
      Model Evaluation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Model Evaluation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#r2" class="md-nav__link">
    <span class="md-ellipsis">
      R2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#root-mean-squared-error-rmse" class="md-nav__link">
    <span class="md-ellipsis">
      Root Mean Squared Error (RMSE)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="machine-learning-models"><strong><em>Machine Learning Models</em></strong></h1>
<p>Both machine learning models were developed in Python; the main libraries used were:</p>
<ul>
<li><em>pandas</em>: Data Extraction &amp;  Transformation </li>
<li><em>numpy</em>: Data Transformation</li>
<li><em>scikit-learn</em>: Machine Learning development</li>
<li><em>joblib</em>: Save the trained ML model</li>
</ul>
<h2 id="feature-selection"><strong><em>Feature Selection</em></strong></h2>
<p>To choose the columns that will be used to train the model, a technique called <strong><em>Mutual Information</em></strong> was used. </p>
<p>This technique is similar to correlation in the aspect that compares the relation between two variables; Nevertheless, <strong><em>Mutual Information can detect any kind of relation, not only linear as correlation does.</em></strong></p>
<p><em>Mutual Information</em> (MI) is a concept from information theory that measures the amount of information shared between two random variables. It quantifies how much knowing one variable reduces the uncertainty about the other. In other words, it tells you how much information about one variable is gained by knowing the value of the other variable.</p>
<p><strong><em>MI goes from 0 to infinity, where 0 indicates no relation at all; In practice, MI values between 0.1 and 0.5 often indicate a moderate relationship, while values above 0.5 suggest a stronger relationship.</em></strong></p>
<p>As MI is is scale-dependent, you could choose the top K MI values, or the ones higher than some threshold. </p>
<p><strong><em>MI only supports numeric values; so all the categorical features had to be encoded using an Ordinal Encoder.</em></strong></p>
<p>Also, a <strong>pearson</strong> and a <strong>spearman</strong> correlation was implemented to know which columns had a linear or near-linear correlation with the target. <strong>Spearman</strong> correlation is used to catch those near-linear relationships, whereas <strong>pearson</strong> is only capable to find linear relationships.</p>
<h2 id="model-development"><strong><em>Model Development</em></strong></h2>
<p>To select which models to tests, the first thing to take into account is to know the type of the target and the objective you want to achieve.</p>
<p>If the objective is to find relations between your data that has not being discovered or labeled, this is, you do not have a built target (Y), then you should try with Unsupervised ML models. On the other hand, if you want to label a new data entry in an already labeled dataset, then you should try with Supervised ML models.</p>
<p>Another thing to take into account, is the data type of your target. If the target is a category, then you should try with classification models. Whether your data is numeric, then you should try with some regression ones.</p>
<p>Its also important to establish if you want to create a parametric or non-parametric model, this is, if you want to create a model based on some assumptions of the relations between your features and your target, or not. Based on this, you should try with some neural networks or not.</p>
<p>In this project, both targets, CO<sub>2</sub> emissions and autonomy are numeric and continous, so <strong>supervised machine learning models, and specifically some regression models, are used</strong>. </p>
<h3 id="feature-encoding"><strong><em>Feature Encoding</em></strong></h3>
<p>Once the models has been selected, its necessary to encode the categorical features based on whether the labels are ordered or unordered, as all the ML models needs to work with numbers.</p>
<p>In this project, <strong>OneHotEncoder</strong> was used for unordered categorical features, and <strong>OrdinalEncoder</strong> for the ordered ones (if exists).</p>
<h3 id="feature-normalization"><strong><em>Feature Normalization</em></strong></h3>
<p>As almost every regression model is very sensitive to the order/hierarchy of the numbers, and the range of values of all the features are different, it was decided to use <strong>MinMaxScaler</strong> to set them all in the same range (0 to 1), avoiding modifying its distributions.</p>
<h3 id="pipeline-generation"><strong><em>Pipeline Generation</em></strong></h3>
<p>As some transformations needs to be done to all the features in the cleaned dataset before being used by any Machine Learning model, <strong>ColumnTransformer</strong> was used to select which type of transformation (encoder/scaler) needs to be done to each feature; moreover, it can also be integrated with <strong>Pipeline</strong>, which orchestrates all the steps to be done to use the model, making it easier to generate a model that can only receive the "raw" dataset values, and return the estimation.</p>
<h2 id="model-evaluation"><strong><em>Model Evaluation</em></strong></h2>
<p>To evaluate the models, <strong>cross validation</strong> (cross_val_score) was used to prevent overfitting and ensuring that the model performs well on unseen data.</p>
<p>It evaluates the model's performance by training it on different subsets of the data and testing it on the remaining parts. This approach provides a more reliable estimate of a model's performance compared to a single train-test split, ensuring that the model's evaluation isn't dependent on any specific data partition.</p>
<p>In sklearn, cross validation allows to implement different evaluation metrics. In this project, two was used:</p>
<h3 id="r2"><strong>R2</strong></h3>
<p>This metric tells how much of the variation of the data can be described by the model. R2 goes from 0 to 1. The nearest to 1, the better the model is.</p>
<h3 id="root-mean-squared-error-rmse"><strong>Root Mean Squared Error (RMSE)</strong></h3>
<p>It measures the average magnitude of the errors between predicted and actual values. It provides an idea of how well a model's predictions match the observed data. Lower values means a better model performance. Since RMSE has the same unit as the target variable, it's easy to interpret as the mean deviation to the real value. </p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class=" text">
    <p>SWAN © Copyright CERN 2016-2024. All rights reserved.</p>
    <ul>
        <li><a target="_blank" href="https://cern.ch/swan/">Home</a></li>
        <li><a target="_blank" href="https://cern.ch/swan-community/">Community</a></li>
        <li><a target="_blank" href="https://cern.service-now.com/service-portal/?id=functional_element&name=swan">Support</a></li>
        <li><a target="_blank" href="https://github.com/swan-cern">Github</a></li>
    </ul>
    <p class="poweredby">Powered by <strong><a href="https://www.mkdocs.org">MkDocs</a></strong> and <strong><a href="https://squidfunk.github.io/mkdocs-material/"> Material for MkDocs</a></strong></p>
</div>
<div class="md-layout-grid--align-right logo">
    <img src="../images/logo_cern.png" alt="CERN">
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.d6f25eb3.min.js"></script>
      
        <script src="../search/main.js"></script>
      
    
  </body>
</html>